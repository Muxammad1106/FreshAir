# Backend Cursor Rules - Django/FreshAIR Project

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π Django
```
backend/apps/
‚îú‚îÄ‚îÄ core/          # –ë–∞–∑–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (Company)
‚îú‚îÄ‚îÄ users/         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îî‚îÄ‚îÄ toolkit/       # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã –∏ –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- –ö–∞–∂–¥–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –º–æ–¥—É–ª–µ–º
- –ò—Å–ø–æ–ª—å–∑—É–π `toolkit` –¥–ª—è –æ–±—â–∏—Ö —É—Ç–∏–ª–∏—Ç –∏ –±–∞–∑–æ–≤—ã—Ö –∫–ª–∞—Å—Å–æ–≤
- –ú–æ–¥–µ–ª–∏ —É—Ä–æ–≤–Ω—è –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–∞—Å–ª–µ–¥—É–π –æ—Ç `BaseCompanyModel`
- –í—Å–µ –º–æ–¥–µ–ª–∏ –Ω–∞—Å–ª–µ–¥—É–π –æ—Ç `toolkit.models.BaseModel`

---

## üìù –ü–æ—Ä—è–¥–æ–∫ —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### 1. –ú–æ–¥–µ–ª–∏ (Models)
**–ü–æ—Ä—è–¥–æ–∫:**
1. –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π –º–æ–¥–µ–ª—å –≤ `models.py`
2. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å - –Ω–∞—Å–ª–µ–¥—É–π –æ—Ç `BaseCompanyModel`
3. –î–æ–±–∞–≤—å `__str__` –º–µ—Ç–æ–¥
4. –û–ø—Ä–µ–¥–µ–ª–∏ `Meta` –∫–ª–∞—Å—Å —Å `db_table`
5. –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ querysets - —Å–æ–∑–¥–∞–π –≤ `querysets/`

**–ü—Ä–∏–º–µ—Ä:**
```python
# apps/core/models.py
from toolkit.models import BaseModel
from core.models import BaseCompanyModel

class MyModel(BaseCompanyModel):  # –∏–ª–∏ BaseModel –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–∞ –∫–æ–º–ø–∞–Ω–∏—è
    name = models.CharField(max_length=255)
    status = models.CharField(max_length=50, choices=STATUS_CHOICES)
    
    def __str__(self):
        return self.name
    
    class Meta:
        db_table = 'core_my_models'
```

### 2. –ú–∏–≥—Ä–∞—Ü–∏–∏
```bash
python manage.py makemigrations
python manage.py migrate
```

### 3. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã (Serializers)
**–ü–æ—Ä—è–¥–æ–∫:**
1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª –≤ `serializers/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
2. –ù–∞—Å–ª–µ–¥—É–π –æ—Ç `BaseModelSerializer` –∏–∑ `toolkit.utils.serializers`
3. –û–ø—Ä–µ–¥–µ–ª–∏ `Meta` –∫–ª–∞—Å—Å —Å `model` –∏ `fields`
4. –î–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
5. –ò—Å–ø–æ–ª—å–∑—É–π `read_only_fields` –¥–ª—è –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω—è—Ç—å—Å—è —á–µ—Ä–µ–∑ API

**–ü—Ä–∏–º–µ—Ä:**
```python
# apps/core/serializers/my_model.py
from toolkit.utils.serializers import BaseModelSerializer
from core.models import MyModel

class MyModelSerializer(BaseModelSerializer):
    class Meta:
        model = MyModel
        fields = ('id', 'name', 'status', 'created_at')
        read_only_fields = ('id', 'created_at')
```

### 4. Views (–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)
**–ü–æ—Ä—è–¥–æ–∫:**
1. –°–æ–∑–¥–∞–π —Ñ–∞–π–ª –≤ `views/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
2. –ù–∞—Å–ª–µ–¥—É–π –æ—Ç `BaseView` –∏–∑ `toolkit.views`
3. –ò—Å–ø–æ–ª—å–∑—É–π –º–∏–∫—Å–∏–Ω—ã: `CreateMixin`, `ListMixin`, `UpdateMixin`, `RetrieveMixin`, `DestroyMixin`
4. –ï—Å–ª–∏ –Ω—É–∂–Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏ - –∏—Å–ø–æ–ª—å–∑—É–π `CompanyMixin` –∏–∑ `core.views.company`
5. –û–ø—Ä–µ–¥–µ–ª–∏ `queryset` –∏ `serializer_class`
6. –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏ –º–µ—Ç–æ–¥—ã —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ –∫–∞—Å—Ç–æ–º–Ω–∞—è –ª–æ–≥–∏–∫–∞

**–ü—Ä–∏–º–µ—Ä:**
```python
# apps/core/views/my_model.py
from core.views.company import CompanyMixin
from toolkit.views import BaseView, CreateMixin, ListMixin, UpdateMixin, RetrieveMixin, DestroyMixin
from core.models import MyModel
from core.serializers.my_model import MyModelSerializer

class MyModelList(CompanyMixin, CreateMixin, ListMixin, BaseView):
    queryset = MyModel.objects.all()
    serializer_class = MyModelSerializer
    ordering = '-created_at'
    ordering_fields = ('created_at', 'name')

class MyModelDetail(CompanyMixin, UpdateMixin, RetrieveMixin, DestroyMixin, BaseView):
    queryset = MyModel.objects.all()
    serializer_class = MyModelSerializer
```

### 5. URLs (–ú–∞—Ä—à—Ä—É—Ç—ã)
**–ü–æ—Ä—è–¥–æ–∫:**
1. –î–æ–±–∞–≤—å –º–∞—Ä—à—Ä—É—Ç—ã –≤ `urls.py` –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ò—Å–ø–æ–ª—å–∑—É–π –ø—Ä–µ—Ñ–∏–∫—Å `/api/v1/{app_name}/`
3. –î–ª—è —Å–ø–∏—Å–∫–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π `/`, –¥–ª—è –¥–µ—Ç–∞–ª–µ–π `/<int:pk>`

**–ü—Ä–∏–º–µ—Ä:**
```python
# apps/core/urls.py
from django.urls import path
from core.views.my_model import MyModelList, MyModelDetail

urlpatterns = [
    path('my-models/', MyModelList.as_view()),
    path('my-models/<int:pk>', MyModelDetail.as_view()),
]
```

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π `CustomTokenAuthentication` –∏–∑ `users.utils.authentication`
- –¢–æ–∫–µ–Ω –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ: `Authorization: Token {token}`
- –í—Å–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ endpoints —Ç—Ä–µ–±—É—é—Ç –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

### –†–∞–∑—Ä–µ—à–µ–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑—É–π Django permissions: `{app}.{action}_{model}`
- –ü—Ä–∏–º–µ—Ä—ã: `core.add_core`, `core.view_core`, `core.change_core`, `core.delete_core`
- –ú–∏–∫—Å–∏–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —á–µ—Ä–µ–∑ `check_perm()`

### –ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `CompanyMixin` –¥–ª—è –º–æ–¥–µ–ª–µ–π —É—Ä–æ–≤–Ω—è –∫–æ–º–ø–∞–Ω–∏–∏
- `CompanyMixin` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
  - –§–∏–ª—å—Ç—Ä—É–µ—Ç queryset –ø–æ `request.user.company`
  - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `company` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏

---

## üìä Querysets

### –ö–æ–≥–¥–∞ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∫–∞—Å—Ç–æ–º–Ω—ã–π QuerySet
- –ï—Å–ª–∏ –Ω—É–∂–Ω—ã —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
- –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ (prefetch_related, select_related)
- –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –∫–∞—Å—Ç–æ–º–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∞–≥—Ä–µ–≥–∞—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä:**
```python
# apps/core/querysets/my_model.py
from toolkit.querysets.base_queryset import BaseQuerySet

class MyModelQuerySet(BaseQuerySet):
    def active(self):
        return self.filter(is_active=True)
    
    def with_relations(self):
        return self.select_related('company').prefetch_related('tags')
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –º–æ–¥–µ–ª–∏:**
```python
class MyModel(BaseCompanyModel):
    # ...
    objects = MyModelQuerySet.as_manager()
```

---

## üéØ Best Practices

### 1. –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- **–ú–æ–¥–µ–ª–∏**: PascalCase, –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ (`core`, `CompanyTag`)
- **Views**: PascalCase —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º (`coreList`, `coreDetail`)
- **Serializers**: PascalCase —Å —Å—É—Ñ—Ñ–∏–∫—Å–æ–º `Serializer` (`coreSerializer`)
- **URLs**: kebab-case, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ (`cores/`, `company-tags/`)
- **–§–∞–π–ª—ã**: snake_case (`core.py`, `my_model.py`)

### 2. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
- –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π `BaseModelSerializer` –¥–ª—è –º–æ–¥–µ–ª–µ–π
- –ò—Å–ø–æ–ª—å–∑—É–π `BaseSerializer` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –±–µ–∑ –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–æ–≤)
- –î–ª—è –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å–æ–∑–¥–∞–≤–∞–π –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
- –ò—Å–ø–æ–ª—å–∑—É–π `read_only_fields` –¥–ª—è –ø–æ–ª–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω—è—Ç—å—Å—è
- –ò—Å–ø–æ–ª—å–∑—É–π `BaseSerializer.check()` –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ views:

```python
# –í view
def post(self, request):
    data = MySerializer.check(request)  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç validated_data
    # –ò—Å–ø–æ–ª—å–∑—É–π data –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
```

- –°–æ–∑–¥–∞–≤–∞–π `Simple{Model}Serializer` –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è JWT —Ç–æ–∫–µ–Ω–æ–≤)

### 3. Views
- –ò—Å–ø–æ–ª—å–∑—É–π –º–∏–∫—Å–∏–Ω—ã –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤
- –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–π `perform_create`/`perform_update` —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–∏
- –ò—Å–ø–æ–ª—å–∑—É–π `list_response()` –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤ —Å–ø–∏—Å–æ–∫
- –í—Å–µ–≥–¥–∞ —É–∫–∞–∑—ã–≤–∞–π `ordering` –∏ `ordering_fields` –¥–ª—è —Å–ø–∏—Å–∫–æ–≤

### 4. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- –ò—Å–ø–æ–ª—å–∑—É–π `select_related()` –¥–ª—è ForeignKey
- –ò—Å–ø–æ–ª—å–∑—É–π `prefetch_related()` –¥–ª—è ManyToMany –∏ –æ–±—Ä–∞—Ç–Ω—ã—Ö ForeignKey
- –ü—Ä–∏–º–µ—Ä: `core.objects.prefetch_related('tags', 'transcripts')`

### 5. –í–∞–ª–∏–¥–∞—Ü–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —É—Ä–æ–≤–Ω–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ —á–µ—Ä–µ–∑ `validate()` –º–µ—Ç–æ–¥
- –î–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–π `serializers.ValidationError`
- –í—Å–µ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–π —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤

### 6. –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –ò—Å–ø–æ–ª—å–∑—É–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è Django REST Framework
- `serializers.ValidationError` –¥–ª—è –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- `PermissionDenied` –¥–ª—è –æ—à–∏–±–æ–∫ –¥–æ—Å—Ç—É–ø–∞ (—á–µ—Ä–µ–∑ `check_perm()`)

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

```
apps/{app_name}/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ models.py              # –í—Å–µ –º–æ–¥–µ–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ admin.py               # Django admin –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)
‚îú‚îÄ‚îÄ apps.py                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ urls.py                # URL –º–∞—Ä—à—Ä—É—Ç—ã
‚îú‚îÄ‚îÄ serializers/           # –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ {model_name}.py
‚îú‚îÄ‚îÄ views/                 # –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ {model_name}.py
‚îú‚îÄ‚îÄ querysets/             # –ö–∞—Å—Ç–æ–º–Ω—ã–µ querysets (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ {model_name}.py
‚îú‚îÄ‚îÄ tests/                 # –¢–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ test_{model_name}.py
‚îú‚îÄ‚îÄ fixtures/              # –§–∏–∫—Å—Ç—É—Ä—ã –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ {model_name}.yaml
‚îî‚îÄ‚îÄ utils/                 # –£—Ç–∏–ª–∏—Ç—ã –º–æ–¥—É–ª—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    ‚îî‚îÄ‚îÄ {utility}.py
```

### Django Admin
–ï—Å–ª–∏ –Ω—É–∂–µ–Ω Django Admin, –∏—Å–ø–æ–ª—å–∑—É–π `BaseAdmin` –∏–∑ `toolkit.admin.base_admin`:

```python
# apps/core/admin.py
from django.contrib import admin
from toolkit.admin.base_admin import BaseAdmin
from core.models import Tag

@admin.register(Tag)
class TagAdmin(BaseAdmin):
    list_display = ('id', 'title', 'created_at')
    search_fields = ('title',)
```

---

## üîÑ –¢–∏–ø–∏—á–Ω—ã–π workflow —Å–æ–∑–¥–∞–Ω–∏—è –Ω–æ–≤–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

1. **–°–æ–∑–¥–∞–π –º–æ–¥–µ–ª—å** –≤ `models.py`
2. **–°–æ–∑–¥–∞–π –º–∏–≥—Ä–∞—Ü–∏–∏**: `python manage.py makemigrations`
3. **–ü—Ä–∏–º–µ–Ω–∏ –º–∏–≥—Ä–∞—Ü–∏–∏**: `python manage.py migrate`
4. **–°–æ–∑–¥–∞–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä** –≤ `serializers/{model_name}.py`
5. **–°–æ–∑–¥–∞–π view** –≤ `views/{model_name}.py`
6. **–î–æ–±–∞–≤—å URL** –≤ `urls.py`
7. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π** —á–µ—Ä–µ–∑ Swagger UI (`/api/v1/toolkit/`)

---

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

1. **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π –º–æ–¥–µ–ª–∏ –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–π**
2. **–ù–ï –∏—Å–ø–æ–ª—å–∑—É–π –ø—Ä—è–º—ã–µ SQL –∑–∞–ø—Ä–æ—Å—ã** - –∏—Å–ø–æ–ª—å–∑—É–π ORM
3. **–ù–ï –∑–∞–±—ã–≤–∞–π –ø—Ä–æ –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å** - –∏—Å–ø–æ–ª—å–∑—É–π `CompanyMixin`
4. **–ù–ï —Å–æ–∑–¥–∞–≤–∞–π –¥—É–±–ª–∏—Ä—É—é—â–∏–π—Å—è –∫–æ–¥** - –∏—Å–ø–æ–ª—å–∑—É–π –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –∏–∑ `toolkit`
5. **–ù–ï –∑–∞–±—ã–≤–∞–π –ø—Ä–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è** - –º–∏–∫—Å–∏–Ω—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∏—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
6. **–í–°–ï–ì–î–ê –∏—Å–ø–æ–ª—å–∑—É–π —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã** –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
7. **–í–°–ï–ì–î–ê —Ñ–∏–ª—å—Ç—Ä—É–π –ø–æ –∫–æ–º–ø–∞–Ω–∏–∏** –¥–ª—è –º–æ–¥–µ–ª–µ–π —É—Ä–æ–≤–Ω—è –∫–æ–º–ø–∞–Ω–∏–∏

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- –¢–µ—Å—Ç—ã —Ä–∞–∑–º–µ—â–∞–π –≤ `tests/` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
- –ù–∞—Å–ª–µ–¥—É–π –æ—Ç `toolkit.tests.base_test.BaseTest`
- –ò—Å–ø–æ–ª—å–∑—É–π —Ñ–∏–∫—Å—Ç—É—Ä—ã –∏–∑ `fixtures/` –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç–∏—Ä—É–π –≤—Å–µ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏
- –¢–µ—Å—Ç–∏—Ä—É–π —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –∏ –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å

---

## üìÅ –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
–ò—Å–ø–æ–ª—å–∑—É–π `file_path` –∏–∑ `toolkit.utils.files` –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—É—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏:

```python
from toolkit.utils.files import file_path

class MyModel(BaseCompanyModel):
    audio = models.FileField(upload_to=file_path('audio/{company_id}'))
    image = models.ImageField(upload_to=file_path('images/{company_id}', custom_name='custom'))
```

### –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ —Ñ–∞–π–ª–∞
–ò—Å–ø–æ–ª—å–∑—É–π `size_2mb` –≤–∞–ª–∏–¥–∞—Ç–æ—Ä:

```python
from toolkit.utils.files import size_2mb

class MyModelSerializer(BaseModelSerializer):
    audio = serializers.FileField(validators=[size_2mb])
```

---

## üìß –†–∞–±–æ—Ç–∞ —Å Email

### –û—Ç–ø—Ä–∞–≤–∫–∞ email
–°–æ–∑–¥–∞–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ `utils/emails.py`:

```python
# apps/users/utils/emails.py
from django.core.mail import send_mail
from django.template.loader import render_to_string

def send_verification_email(request, user):
    subject = '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email'
    html_message = render_to_string('users/confirm_email.html', {'user': user})
    send_mail(subject, '', settings.DEFAULT_FROM_EMAIL, [user.email], html_message=html_message)
```

---

## üîÑ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
–ò—Å–ø–æ–ª—å–∑—É–π `@transaction.atomic` –¥–ª—è –∞—Ç–æ–º–∞—Ä–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π:

```python
from django.db import transaction

class MyView(CreateMixin, BaseView):
    @transaction.atomic
    def perform_create(self, serializer):
        instance = serializer.save()
        # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∞—Ç–æ–º–∞—Ä–Ω—ã–º–∏
        related_obj = RelatedModel.objects.create(parent=instance)
```

---

## üîë Refresh —Ç–æ–∫–µ–Ω–æ–≤

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è refresh
–ò—Å–ø–æ–ª—å–∑—É–π –∫–∞—Å—Ç–æ–º–Ω—ã–π queryset –¥–ª—è refresh —Ç–æ–∫–µ–Ω–æ–≤:

```python
# apps/users/querysets/token.py
class TokenQuerySet(BaseQuerySet):
    def refresh(self, old_token):
        old_token.is_active = False
        old_token.save()
        return self.create(user=old_token.user)
```

---

## üìÖ –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç–∞–º–∏

### –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –¥–∞—Ç
–ò—Å–ø–æ–ª—å–∑—É–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `toolkit.utils.date`:

```python
from toolkit.utils.date import month_first_last_days, add_months

first_day, last_day = month_first_last_days()
next_month = add_months(today, 1)
```

---

## üõ†Ô∏è Helpers —Ñ—É–Ω–∫—Ü–∏–∏

### –ü–æ–ª–µ–∑–Ω—ã–µ —É—Ç–∏–ª–∏—Ç—ã
–ò—Å–ø–æ–ª—å–∑—É–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `toolkit.utils.helpers`:

```python
from toolkit.utils.helpers import integers_only, human_readable_num

phone = integers_only('+998(91) 333 33 33')  # '998913333333'
formatted = human_readable_num(12345)  # '12 345'
```

---

## üîí Permission –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
–ò—Å–ø–æ–ª—å–∑—É–π –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä `permission` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:

```python
from toolkit.utils.permission import permission

class MyView(BaseView):
    @permission('core.add_core')
    def post(self, request):
        # –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–∏—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ
        pass
```

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è

### –ö–∞—Å—Ç–æ–º–Ω—ã–µ default —Ñ—É–Ω–∫—Ü–∏–∏
–ò—Å–ø–æ–ª—å–∑—É–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ `users.utils.fields`:

```python
from users.utils.fields import expires_default, expires_hour

class Token(BaseModel):
    expires_at = models.DateTimeField(default=expires_default)  # 2 —á–∞—Å–∞
    reset_expires = models.DateTimeField(default=expires_hour)   # 1 —á–∞—Å
```

---

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- Swagger UI: `/api/v1/toolkit/`
- Django Admin: `/admin/`
- –í—Å–µ endpoints –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å `/api/v1/`

