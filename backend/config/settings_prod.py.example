import os
import sentry_sdk
from sentry_sdk.integrations.django import DjangoIntegration
from .settings import *


# Database Configuration
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql',
        'NAME': 'fresh2',
        'USER': 'suv',
        'PASSWORD': 'suv',
        'HOST': os.environ.get('POSTGRES_HOST', 'localhost'),
        'PORT': os.environ.get('POSTGRES_PORT', 5432),
    }
}

# Sentry Configuration (опционально)
if os.environ.get('SENTRY_URL'):
    sentry_sdk.init(
        dsn=os.environ.get('SENTRY_URL', ''),
        integrations=[DjangoIntegration()],
        send_default_pii=True
    )

# Frontend Domain
FRONTEND_DOMAIN = os.environ.get('FRONTEND_DOMAIN', 'https://airly.life')

# Email Configuration
EMAIL_HOST = os.environ.get('EMAIL_HOST', 'smtp.mail.ru')
EMAIL_USE_TLS = os.environ.get('EMAIL_USE_TLS', 'True') == 'True'
EMAIL_PORT = int(os.environ.get('EMAIL_PORT', 2525))
EMAIL_HOST_USER = os.environ.get('EMAIL_HOST_USER', '')
EMAIL_HOST_PASSWORD = os.environ.get('EMAIL_HOST_PASSWORD', '')

SERVER_EMAIL = EMAIL_HOST_USER
DEFAULT_FROM_EMAIL = EMAIL_HOST_USER

# Static and Media files
STATIC_ROOT = os.environ.get('STATIC_ROOT', '/static')
MEDIA_ROOT = os.environ.get('MEDIA_ROOT', '/uploads')

# Debug mode - обязательно False для production
DEBUG = False

# Allowed Hosts (переопределяем для production)
ALLOWED_HOSTS = os.environ.get('ALLOWED_HOSTS', 'api.airly.life,airly.life,localhost,127.0.0.1,backend').split(',')

# Security settings
SECURE_SSL_REDIRECT = os.environ.get('SECURE_SSL_REDIRECT', 'False') == 'True'
SESSION_COOKIE_SECURE = os.environ.get('SESSION_COOKIE_SECURE', 'False') == 'True'
CSRF_COOKIE_SECURE = os.environ.get('CSRF_COOKIE_SECURE', 'False') == 'True'
